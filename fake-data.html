<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CSV / JSON / SQL / Excel Data Generator</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.datatables.net/2.3.2/css/dataTables.dataTables.css" />
<style>
    .field-row { cursor: move; }
</style>
</head>
<body class="p-4">

<div class="container">
    <h2 class="mb-3">Data Generator</h2>


    <div class="row mb-3">

    <div class="col">
        <label>Number of Rows</label>
        <input type="number" id="rowCount" class="form-control" value="10" min="1">
    </div>

<div class="col">
        <label>Download Format</label>
        <select id="downloadFormat" class="form-select">
            <option value="csv">CSV</option>
            <option value="json">JSON</option>
            <option value="sql">SQL</option>
            <option value="excel">Excel</option>
        </select>
    </div>

    <div class="col">
<div id="jsonOptions" class="mb-3" style="display:none;">
        <input type="checkbox" id="jsonArray" checked> <label for="jsonArray">Array format</label>
    </div>

    <div id="sqlOptions" class="mb-3" style="display:none;">
        <label>Table Name</label>
        <input type="text" id="sqlTableName" class="form-control mb-2" value="my_table">
        <input type="checkbox" id="includeCreateTable" checked> <label for="includeCreateTable">Include CREATE TABLE</label>
    </div>
    </div>

    <div class="col">
          <button id="generateBtn" class="btn btn-success mb-3">Generate Data</button>

    </div>

    </div>

    

    <table class="table table-bordered" id="fieldsTable">
        <thead>
            <tr>
                <th>Field Name</th>
                <th>Type</th>
                <th>Min</th>
                <th>Max</th>
                <th>Default Value</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="fieldsBody">
            <tr class="field-row">
                <td><input type="text" class="form-control" value="id" readonly></td>
                <td><select class="form-select typeSelect"></select></td>
                <td></td><td></td>
                <td><input type="text" class="form-control"></td>
                <td></td>
            </tr>
            <tr class="field-row">
                <td><input type="text" class="form-control" value="name"></td>
                <td><select class="form-select typeSelect"></select></td>
                <td></td><td></td>
                <td><input type="text" class="form-control"></td>
                <td><button class="btn btn-danger btn-sm removeField">X</button></td>
            </tr>
            <tr class="field-row">
                <td><input type="text" class="form-control" value="gender"></td>
                <td><select class="form-select typeSelect"></select></td>
                <td></td><td></td>
                <td><input type="text" class="form-control"></td>
                <td><button class="btn btn-danger btn-sm removeField">X</button></td>
            </tr>
        </tbody>
    </table>

    <button id="addField" class="btn btn-primary">Add Field</button>
      <button id="downloadBtn" class="btn btn-info " style="display:none;">Download</button>
  

    

    

    <h4>Preview</h4>
    <table id="previewTable" class="display" style="width:100%">
        <thead></thead>
        <tbody></tbody>
    </table>

    
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/2.3.2/js/dataTables.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<script>
const fieldTypes = [
    "id","firstName","lastName","fullName","maidenName","email","phone","age",
    "birthDate","gender","ipAddress","boolean","address","city","state","stateCode",
    "postalCode","country","companyName","companyAddress","companyPhone","number"
];
let userData = [];

// Fetch user data
fetch("https://dummyjson.com/users?limit=100")
    .then(res => res.json())
    .then(data => { userData = data.users; });

// Populate dropdowns
function populateTypeSelect(select, selected) {
    fieldTypes.forEach(type => {
        const opt = document.createElement("option");
        opt.value = type;
        opt.textContent = type;
        if (type === selected) opt.selected = true;
        select.appendChild(opt);
    });
}

document.querySelectorAll(".typeSelect").forEach((sel, idx) => {
    if (idx === 0) populateTypeSelect(sel, "id");
    else if (idx === 1) populateTypeSelect(sel, "fullName");
    else if (idx === 2) populateTypeSelect(sel, "gender");
});

// Add field row
$("#addField").on("click", function(){
    let tr = document.createElement("tr");
    tr.className = "field-row";
    tr.innerHTML = `
        <td><input type="text" class="form-control" value=""></td>
        <td><select class="form-select typeSelect"></select></td>
        <td><input type="number" class="form-control minVal" style="display:none;"></td>
        <td><input type="number" class="form-control maxVal" style="display:none;"></td>
        <td><input type="text" class="form-control"></td>
        <td><button class="btn btn-danger btn-sm removeField">X</button></td>
    `;
    document.querySelector("#fieldsBody").appendChild(tr);
    populateTypeSelect(tr.querySelector(".typeSelect"), "");
});

// Remove field
$(document).on("click", ".removeField", function(){
    $(this).closest("tr").remove();
});

// Show Min/Max for number type
$(document).on("change", ".typeSelect", function(){
    let row = $(this).closest("tr");
    if ($(this).val() === "number") {
        row.find(".minVal, .maxVal").show();
    } else {
        row.find(".minVal, .maxVal").hide();
    }
});

// Drag-and-drop
new Sortable(document.getElementById("fieldsBody"), { animation: 150 });

// Format change UI
$("#downloadFormat").on("change", function(){
    $("#jsonOptions, #sqlOptions").hide();
    if (this.value === "json") $("#jsonOptions").show();
    if (this.value === "sql") $("#sqlOptions").show();
});

// Generate data
let generatedData = [];
let generatedHeaders = [];

$("#generateBtn").on("click", function(){
    let rows = parseInt($("#rowCount").val());
    let fields = [];
    $("#fieldsBody tr").each(function(){
        let name = $(this).find("td:eq(0) input").val();
        let type = $(this).find(".typeSelect").val();
        let min = $(this).find(".minVal").val();
        let max = $(this).find(".maxVal").val();
        let def = $(this).find("td:eq(4) input").val();
        fields.push({name, type, min, max, def});
    });

    let output = [];
    for (let i=0; i<rows; i++) {
        let row = {};
        fields.forEach(f => row[f.name] = generateFieldData(f, i));
        output.push(row);
    }
    generatedData = output;
    generatedHeaders = fields.map(f=>f.name);

    if ($.fn.DataTable.isDataTable('#previewTable')) {
        $('#previewTable').DataTable().destroy();
    }
    $("#previewTable thead").html("<tr>"+generatedHeaders.map(h=>`<th>${h}</th>`).join("")+"</tr>");
    $("#previewTable tbody").html(output.map(r => "<tr>"+generatedHeaders.map(h=>`<td>${r[h]}</td>`).join("")+"</tr>").join(""));
    $('#previewTable').DataTable({paging:true, searching:true, info:true});
    $("#downloadBtn").show();
});

function generateFieldData(f, index) {
    if (f.def) return f.def;
    let user = userData[index % userData.length] || {};
    switch(f.type) {
        case "id": return index+1;
        case "firstName": return user.firstName || "";
        case "lastName": return user.lastName || "";
        case "fullName": return `${user.firstName || ""} ${user.lastName || ""}`;
        case "maidenName": return user.maidenName || "";
        case "email": return user.email || "";
        case "phone": return user.phone || "";
        case "age": return user.age || "";
        case "birthDate": return user.birthDate || "";
        case "gender": return user.gender || "";
        case "address": return user.address?.address || "";
        case "ipAddress": return `${rand(1,255)}.${rand(0,255)}.${rand(0,255)}.${rand(0,255)}`;
        case "boolean": return Math.random() < 0.5 ? "true" : "false";
        case "city": return user.address?.city || "";
        case "state": return user.address?.state || "";
        case "stateCode": return user.address?.stateCode || "";
        case "postalCode": return user.address?.postalCode || "";
        case "country": return user.address?.country || "";
        case "companyName": return user.company?.name || "";
        case "companyAddress": return user.company?.address?.address || "";
        case "companyPhone": return user.company?.phone || "";
        case "number":
            let min = parseInt(f.min) || 0;
            let max = parseInt(f.max) || 1000;
            return rand(min, max);
        default: return "";
    }
}
function rand(min, max) { return Math.floor(Math.random()*(max-min+1))+min; }

// Download button
$("#downloadBtn").on("click", function(){
    let format = $("#downloadFormat").val();
    if (format === "csv") {
        let csv = generatedHeaders.join(",") + "\n";
        generatedData.forEach(r => { csv += generatedHeaders.map(h => `"${r[h]}"`).join(",") + "\n"; });
        downloadFile(csv, "data.csv", "text/csv");
    } else if (format === "json") {
        if ($("#jsonArray").is(":checked")) {
            downloadFile(JSON.stringify(generatedData, null, 2), "data.json", "application/json");
        } else {
            let text = generatedData.map(o => JSON.stringify(o)).join("\r\n");
            downloadFile(text, "data.json", "application/json");
        }
    } else if (format === "sql") {
        let table = $("#sqlTableName").val() || "my_table";
        let sql = "";
        if ($("#includeCreateTable").is(":checked")) {
            sql += `CREATE TABLE ${table} (${generatedHeaders.map(h => `\`${h}\` TEXT`).join(", ")});\n`;
        }
        generatedData.forEach(r => {
            sql += `INSERT INTO ${table} (${generatedHeaders.join(", ")}) VALUES (${generatedHeaders.map(h => `'${r[h]}'`).join(", ")});\n`;
        });
        downloadFile(sql, "data.sql", "application/sql");
    } else if (format === "excel") {
        let ws = XLSX.utils.json_to_sheet(generatedData);
        let wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Data");
        XLSX.writeFile(wb, "data.xlsx");
    }
});

function downloadFile(content, fileName, type) {
    let blob = new Blob([content], { type });
    let a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = fileName;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
}
</script>
</body>
</html>
